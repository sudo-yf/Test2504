# é«˜çº§æƒ…ç»ªè¯†åˆ«æ¨¡å‹æŒ‡å—

æœ¬æ–‡æ¡£ä»‹ç» EmotiSense æ”¯æŒçš„å¤šç§å…ˆè¿›æƒ…ç»ªè¯†åˆ«æ¨¡å‹åŠå…¶ä½¿ç”¨æ–¹æ³•ã€‚

## ğŸ“Š æ”¯æŒçš„æ¨¡å‹

### 1. **HSEmotion (æ¨è)** â­

**ç®€ä»‹**ï¼š
- ç”± HSE å¤§å­¦å¼€å‘çš„é«˜é€Ÿæƒ…ç»ªè¯†åˆ«åº“
- åœ¨ ABAW ç«èµ›ä¸­è·å¾—å¤šä¸ªç¬¬ä¸€å
- åŸºäº EfficientNet æ¶æ„ï¼Œåœ¨ VGGFace2 å’Œ AffectNet ä¸Šé¢„è®­ç»ƒ

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- **å‡†ç¡®ç‡**: 66%+ (AffectNet 8ç±»)
- **æ¨ç†é€Ÿåº¦**: ~60ms (ç§»åŠ¨è®¾å¤‡)
- **æ¨¡å‹å¤§å°**: 16-30MB
- **æ”¯æŒæƒ…ç»ª**: 8ç±»æˆ–7ç±»

**8ç±»æƒ…ç»ª**ï¼š
- angry (æ„¤æ€’)
- contempt (è½»è”‘)
- disgust (åŒæ¶)
- fear (ææƒ§)
- happy (å¿«ä¹)
- neutral (ä¸­æ€§)
- sad (æ‚²ä¼¤)
- surprise (æƒŠè®¶)

**å¯ç”¨æ¨¡å‹**ï¼š
```yaml
# åœ¨ config.yaml ä¸­é…ç½®
emotion:
  detector_type: 'hsemotion'
  hsemotion_model: 'enet_b0_8_best_afew'  # æ¨è
  
# å…¶ä»–å¯é€‰æ¨¡å‹ï¼š
# - enet_b0_8_best_afew  (æœ€ä½³ AFEW æ€§èƒ½)
# - enet_b0_8_best_vgaf  (æœ€ä½³ VGAF æ€§èƒ½)
# - enet_b2_8            (æ›´å¤§æ¨¡å‹ï¼Œæ›´é«˜å‡†ç¡®ç‡)
# - enet_b0_7            (7ç±»æƒ…ç»ª)
# - enet_b2_7            (7ç±»æƒ…ç»ªï¼Œæ›´å¤§æ¨¡å‹)
```

**ä¼˜ç‚¹**ï¼š
- âœ… é€Ÿåº¦å¿«
- âœ… å‡†ç¡®ç‡é«˜
- âœ… æ¨¡å‹å°
- âœ… æ”¯æŒå¤šç§é¢„è®­ç»ƒæ¨¡å‹

**ç¼ºç‚¹**ï¼š
- âŒ éœ€è¦é¢å¤–å®‰è£…ä¾èµ–

---

### 2. **FER (Facial Expression Recognition)**

**ç®€ä»‹**ï¼š
- è½»é‡çº§æ·±åº¦å­¦ä¹ æƒ…ç»ªè¯†åˆ«åº“
- åŸºäº CNN æ¶æ„
- æ”¯æŒå®æ—¶è§†é¢‘åˆ†æ

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- **å‡†ç¡®ç‡**: ~65% (FER2013)
- **æ¨ç†é€Ÿåº¦**: ~100-200ms
- **æ¨¡å‹å¤§å°**: ~5MB
- **æ”¯æŒæƒ…ç»ª**: 7ç±»

**7ç±»æƒ…ç»ª**ï¼š
- angry (æ„¤æ€’)
- disgust (åŒæ¶)
- fear (ææƒ§)
- happy (å¿«ä¹)
- sad (æ‚²ä¼¤)
- surprise (æƒŠè®¶)
- neutral (ä¸­æ€§)

**é…ç½®**ï¼š
```yaml
emotion:
  detector_type: 'fer'
  fer_use_mtcnn: false  # ä½¿ç”¨ MTCNN äººè„¸æ£€æµ‹ï¼ˆæ›´å‡†ç¡®ä½†æ›´æ…¢ï¼‰
```

**ä¼˜ç‚¹**ï¼š
- âœ… æ˜“äºä½¿ç”¨
- âœ… è½»é‡çº§
- âœ… å¯é€‰ MTCNN äººè„¸æ£€æµ‹

**ç¼ºç‚¹**ï¼š
- âŒ å‡†ç¡®ç‡ç•¥ä½
- âŒ é€Ÿåº¦è¾ƒæ…¢

---

### 3. **DeepFace (é»˜è®¤)**

**ç®€ä»‹**ï¼š
- ç»¼åˆæ€§äººè„¸åˆ†ææ¡†æ¶
- æ”¯æŒå¤šç§åç«¯æ¨¡å‹
- åŠŸèƒ½ä¸°å¯Œï¼ˆå¹´é¾„ã€æ€§åˆ«ã€ç§æ—ç­‰ï¼‰

**æ€§èƒ½æŒ‡æ ‡**ï¼š
- **å‡†ç¡®ç‡**: ~60-65%
- **æ¨ç†é€Ÿåº¦**: ~200-500ms
- **æ¨¡å‹å¤§å°**: ~100MB (TensorFlow)
- **æ”¯æŒæƒ…ç»ª**: 7ç±»

**é…ç½®**ï¼š
```yaml
emotion:
  detector_type: 'deepface'
```

**ä¼˜ç‚¹**ï¼š
- âœ… åŠŸèƒ½å…¨é¢
- âœ… æ”¯æŒå¤šç§åˆ†æä»»åŠ¡
- âœ… ç¤¾åŒºæ´»è·ƒ

**ç¼ºç‚¹**ï¼š
- âŒ é€Ÿåº¦è¾ƒæ…¢
- âŒ æ¨¡å‹è¾ƒå¤§
- âŒ ä¾èµ–è¾ƒå¤š

---

### 4. **Ensemble (é›†æˆæ¨¡å‹)**

**ç®€ä»‹**ï¼š
- ç»“åˆå¤šä¸ªæ¨¡å‹çš„é¢„æµ‹ç»“æœ
- é€šè¿‡æŠ•ç¥¨æˆ–å¹³å‡æé«˜å‡†ç¡®ç‡
- å¯è‡ªå®šä¹‰æ¨¡å‹ç»„åˆ

**é…ç½®**ï¼š
```yaml
emotion:
  detector_type: 'ensemble'
  ensemble_models:
    - 'hsemotion'
    - 'fer'
    # - 'deepface'  # å¯é€‰
```

**ä¼˜ç‚¹**ï¼š
- âœ… å‡†ç¡®ç‡æœ€é«˜
- âœ… é²æ£’æ€§å¼º
- âœ… å¯è‡ªå®šä¹‰ç»„åˆ

**ç¼ºç‚¹**ï¼š
- âŒ é€Ÿåº¦æœ€æ…¢ï¼ˆéœ€è¿è¡Œå¤šä¸ªæ¨¡å‹ï¼‰
- âŒ å†…å­˜å ç”¨å¤§

---

## ğŸš€ å®‰è£…å’Œä½¿ç”¨

### å®‰è£…ä¾èµ–

**åŸºç¡€å®‰è£…**ï¼ˆä»… DeepFaceï¼‰ï¼š
```bash
pip install -r requirements.txt
```

**å®‰è£… HSEmotion**ï¼ˆæ¨èï¼‰ï¼š
```bash
pip install hsemotion timm
```

**å®‰è£… FER**ï¼š
```bash
pip install fer
```

**å®‰è£…æ‰€æœ‰æ¨¡å‹**ï¼š
```bash
pip install hsemotion timm fer
```

### é…ç½®æ¨¡å‹

ç¼–è¾‘ `config.yaml`ï¼š

```yaml
emotion:
  # é€‰æ‹©æ£€æµ‹å™¨: 'deepface', 'hsemotion', 'fer', 'ensemble'
  detector_type: 'hsemotion'
  
  # HSEmotion é…ç½®
  hsemotion_model: 'enet_b0_8_best_afew'
  
  # FER é…ç½®
  fer_use_mtcnn: false
  
  # Ensemble é…ç½®
  ensemble_models:
    - 'hsemotion'
    - 'fer'
```

### è¿è¡Œåº”ç”¨

```bash
python main.py
```

åº”ç”¨ä¼šè‡ªåŠ¨åŠ è½½é…ç½®çš„æ¨¡å‹ã€‚

---

## ğŸ”¬ æ¨¡å‹å¯¹æ¯”å·¥å…·

ä½¿ç”¨ `compare_models.py` å¯¹æ¯”ä¸åŒæ¨¡å‹çš„æ€§èƒ½ï¼š

### å›¾ç‰‡æ¨¡å¼

```bash
python compare_models.py --mode image --image path/to/image.jpg
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
COMPARISON RESULTS
======================================================================
DeepFace       : happy      ( 98.5%) -   245.3ms
HSEmotion      : happy      ( 96.2%) -    58.7ms
FER            : happy      ( 92.1%) -   156.4ms
```

### å®æ—¶æ‘„åƒå¤´æ¨¡å¼

```bash
python compare_models.py --mode webcam --duration 30
```

è¿™å°†è¿è¡Œ30ç§’ï¼Œå®æ—¶å¯¹æ¯”æ‰€æœ‰æ¨¡å‹çš„ï¼š
- æƒ…ç»ªè¯†åˆ«ç»“æœ
- æ¨ç†æ—¶é—´
- æƒ…ç»ªåˆ†å¸ƒç»Ÿè®¡

---

## ğŸ“ˆ æ€§èƒ½å¯¹æ¯”

| æ¨¡å‹ | å‡†ç¡®ç‡ | é€Ÿåº¦ | æ¨¡å‹å¤§å° | æ¨èåœºæ™¯ |
|------|--------|------|----------|----------|
| **HSEmotion** | â­â­â­â­â­ | â­â­â­â­â­ | â­â­â­â­ | **ç”Ÿäº§ç¯å¢ƒã€å®æ—¶åº”ç”¨** |
| **FER** | â­â­â­â­ | â­â­â­ | â­â­â­â­â­ | è½»é‡çº§åº”ç”¨ |
| **DeepFace** | â­â­â­â­ | â­â­ | â­â­ | å¤šåŠŸèƒ½åˆ†æ |
| **Ensemble** | â­â­â­â­â­ | â­ | â­ | é«˜å‡†ç¡®ç‡éœ€æ±‚ |

---

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### åœºæ™¯æ¨è

1. **å®æ—¶åº”ç”¨ï¼ˆæ¨èï¼‰**ï¼š
   ```yaml
   detector_type: 'hsemotion'
   hsemotion_model: 'enet_b0_8_best_afew'
   ```

2. **é«˜å‡†ç¡®ç‡éœ€æ±‚**ï¼š
   ```yaml
   detector_type: 'ensemble'
   ensemble_models: ['hsemotion', 'fer']
   ```

3. **èµ„æºå—é™ç¯å¢ƒ**ï¼š
   ```yaml
   detector_type: 'fer'
   fer_use_mtcnn: false
   ```

4. **ç ”ç©¶å’Œå®éªŒ**ï¼š
   ```yaml
   detector_type: 'deepface'
   ```

### æ€§èƒ½ä¼˜åŒ–

1. **æé«˜é€Ÿåº¦**ï¼š
   - ä½¿ç”¨ HSEmotion
   - å¢åŠ  `detection_interval`
   - å¢åŠ  `frame_skip`

2. **æé«˜å‡†ç¡®ç‡**ï¼š
   - ä½¿ç”¨ Ensemble
   - ä½¿ç”¨æ›´å¤§çš„ HSEmotion æ¨¡å‹ï¼ˆenet_b2ï¼‰
   - ç¡®ä¿è‰¯å¥½çš„å…‰ç…§æ¡ä»¶

3. **é™ä½å†…å­˜**ï¼š
   - ä½¿ç”¨ FER
   - é™ä½è§†é¢‘åˆ†è¾¨ç‡
   - å‡å°‘ `max_data_records`

---

## ğŸ”§ æ•…éšœæ’é™¤

### HSEmotion å®‰è£…é—®é¢˜

```bash
# ç¡®ä¿å®‰è£…æ­£ç¡®ç‰ˆæœ¬çš„ timm
pip install timm>=0.9.0

# å¦‚æœé‡åˆ°ç‰ˆæœ¬å†²çª
pip install --upgrade hsemotion timm
```

### FER å®‰è£…é—®é¢˜

```bash
# FER éœ€è¦ TensorFlow
pip install tensorflow fer
```

### æ¨¡å‹åŠ è½½å¤±è´¥

æ£€æŸ¥æ—¥å¿—è¾“å‡ºï¼Œç¡®ä¿ï¼š
1. ä¾èµ–å·²æ­£ç¡®å®‰è£…
2. é…ç½®æ–‡ä»¶ä¸­çš„æ¨¡å‹åç§°æ­£ç¡®
3. ç½‘ç»œè¿æ¥æ­£å¸¸ï¼ˆé¦–æ¬¡ä½¿ç”¨ä¼šä¸‹è½½æ¨¡å‹ï¼‰

---

## ğŸ“š å‚è€ƒèµ„æ–™

### HSEmotion
- GitHub: https://github.com/HSE-asavchenko/face-emotion-recognition
- è®ºæ–‡: "Facial Expression Recognition with Adaptive Frame Rate" (ICML 2023)

### FER
- GitHub: https://github.com/justinshenk/fer
- PyPI: https://pypi.org/project/fer/

### DeepFace
- GitHub: https://github.com/serengil/deepface
- è®ºæ–‡: Multiple backend models supported

---

## ğŸ¯ æ€»ç»“

- **æœ€ä½³é€‰æ‹©**: HSEmotion (é€Ÿåº¦å¿«ã€å‡†ç¡®ç‡é«˜)
- **å¤‡é€‰æ–¹æ¡ˆ**: FER (è½»é‡çº§)
- **é«˜å‡†ç¡®ç‡**: Ensemble (ç»„åˆå¤šä¸ªæ¨¡å‹)
- **å¤šåŠŸèƒ½**: DeepFace (æ”¯æŒå¤šç§åˆ†æ)

æ ¹æ®ä½ çš„å…·ä½“éœ€æ±‚é€‰æ‹©åˆé€‚çš„æ¨¡å‹ï¼

